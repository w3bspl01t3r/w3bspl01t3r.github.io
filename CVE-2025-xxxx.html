<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CVE-2025-xxxx: Remote Code Execution In TrackPlus Allegra | zdaylabs</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1f2e 0%, #2d3748 50%, #1e3a5f 100%);
      color: #dcdcdc;
      line-height: 1.6;
      padding: 0 2rem;
      min-height: 100vh;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2rem 0 1rem;
      border-bottom: 1px solid #333;
    }
    
    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      color: #ffffff;
    }
    
    nav a {
      margin: 0 1rem;
      text-decoration: none;
      color: #ccc;
      font-size: 0.95rem;
    }
    
    nav a:hover {
      color: #fef200;
    }
    
    .socials a {
      margin-left: 1rem;
      color: #999;
      font-size: 1.2rem;
      text-decoration: none;
    }
    
    main {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    
    h1 {
      font-size: 2.5rem;
      color: #fff;
      margin-bottom: 1rem;
    }
    
    h2 {
      color: #fef200;
      font-size: 1.8rem;
      margin: 2rem 0 1rem;
      border-bottom: 2px solid #333;
      padding-bottom: 0.5rem;
      text-align: left;
    }
    
    h3 {
      color: #fef200;
      font-size: 1.4rem;
      margin: 1.5rem 0 0.8rem;
    }
    
    p {
      margin-bottom: 1.2rem;
      color: #bbb;
    }
    
    code {
      color: #36d1dc;
      font-family: 'Courier New', monospace;
    }
    
    pre {
      background-color: #1e2329;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 1rem;
      overflow-x: auto;
      margin: 1rem 0;
    }
    
    img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      margin: 1rem 0;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    video {
      display: block;
      width: 100%;
      height: auto;
      border-radius: 8px;
      margin: 1rem 0;
      background: #000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    ul {
      color: #bbb;
      margin-left: 1.5rem;
    }
    
    li {
      margin-bottom: 0.5rem;
    }
    
    a {
      color: #36d1dc;
      text-decoration: none;
    }
    
    a:hover {
      color: #fef200;
      text-decoration: underline;
    }
    
    .highlight {
      background: rgba(254, 242, 0, 0.1);
      color: #fef200;
      padding: 0.1rem 0.3rem;
      border-radius: 3px;
    }
    
    .cve-info {
      background: rgba(54, 209, 220, 0.1);
      border: 1px solid #36d1dc;
      border-radius: 8px;
      padding: 1.5rem;
      margin: 2rem 0;
    }
    
    .cve-info h3 {
      margin-top: 0;
      color: #36d1dc;
    }
    
    .severity {
      display: inline-block;
      padding: 0.3rem 0.8rem;
      border-radius: 4px;
      font-weight: bold;
      font-size: 0.9rem;
    }
    
    .severity.high {
      background: rgba(255, 69, 58, 0.2);
      color: #ff453a;
      border: 1px solid #ff453a;
    }
    
    footer {
      text-align: center;
      padding: 2rem 0;
      border-top: 1px solid #333;
      margin-top: 3rem;
      color: #999;
    }
    
    .social-links {
      margin-top: 1rem;
    }
    
    .social-links a {
      margin: 0 1rem;
      color: #36d1dc;
    }
  </style>
</head>
<body>
  <div id="navigation-placeholder"></div>
  <script src="navigation.js"></script>

  <main>
    <h1>CVE-2025-xxxx: Remote Code Execution In TrackPlus Allegra</h1>
    <div class="cve-info">
      <h3>CVE Information</h3>
      <p><strong>CVE ID:</strong> CVE-2025-xxxx</p>
      <p><strong>Severity:</strong> <span class="severity high">HIGH</span></p>
      <p><strong>CVSS Score:</strong> 7.2</p>
      <p><strong>Affected Product:</strong> TrackPlus Allegra</p>
      <p><strong>Vulnerability Type:</strong> Remote Code Execution</p>
      <p><strong>Discovery Date:</strong> September 2025</p>
    </div>

 <h2>Executive Summary</h2> 
 <p> A critical Remote Code Execution (RCE) vulnerability was identified in TrackPlus Allegra version <strong>8.1.6</strong>. 
  The flaw allows an authenticated administrator to place a web shell on the underlying server, resulting in full command execution under the application context. </p>
<h2>Technical Details</h2> 
<p> The vulnerability resides in the application's Backup Restore mechanism. Due to an insecure design, the application permits administrators to restore attachments to an arbitrary, administrator-configurable filesystem location. That restore path is susceptible to path traversal, allowing an attacker to write files (for example, a web shell) into the application's web root. </p> 
<h3>Vulnerability Analysis</h3> 
<p> TrackPlus Allegra is a project-management application that supports reports containing attachments. Report packages are zip archives that must include a required <code>description.xml</code> file; uploaded report zips are extracted into a per-report folder under <code>/home/allegra/reportTemplates/exportTemplate00XXX</code>, where <code>XXX</code> is a numerical identifier incremented per report. </p>



<p>
  <img src="images/allegra/reportsUI.jpg" alt="Screenshot of reports">
</p>
<p>
  <img src="images/allegra/exporttemplatesssh.png" alt="Screenshot of exportTemplate00XXX">
</p>
<p> The restore functionality accepts backup zip files from a configurable backup directory (default: <code>/home/allegra/dbBackup</code>). An administrator may change this backup directory via server configuration. If a crafted backup archive is placed into any directory that the administrator configures as the backup directory, it appears in the restore UI. When the restore operation writes attachments, the configured restore-destination path is used without sufficient validation, enabling path traversal. </p>

<p><img src="images/allegra/dbpathconfig.jpg" alt="dbpathconfig"></p>


<p>
  <img src="images/allegra/restoreUI.jpg" alt="restoreUI">
</p>

<p> An attacker can: 
  <ul> <li>create a malicious backup archive containing a web shell;</li>
  <li>place that archive under a report exportTemplate folder by uploading a specially-crafted report zip (report upload extracts into <code>/home/allegra/reportTemplates/exportTemplate00XXX</code> and returns the numeric ID);</li>
  <li>change the application's backup directory to the matching <code>exportTemplate00XXX</code> folder;</li> 
  <li>invoke the restore workflow with the <em>Restore attachments</em> option enabled and set the attachment restore location to a path such as <code>../../../../../../../../../../../../../../../usr/local/tomcat/webapps/demo/js/</code>;</li>
  <li>the restore process then writes the web shell into the web root, leading to RCE via HTTP requests to the shell.</li> 
  </ul>
  </p> 
<h3>Exploitation Walkthrough (high level)</h3>
<p> To avoid intermediate unzip/rejection checks, the exploit uses a double-zipping approach: build the malicious backup zip (first layer), then place it inside a second zip that also contains the mandatory
<code>description.xml</code> (second layer). Upload the second-layer zip using the report upload feature so it lands in 
<code>/home/allegra/reportTemplates/exportTemplate00XXX</code> and note the returned ID. Reconfigure the backup directory to that exportTemplate path, then run the restore operation selecting the uploaded backup and specifying the path traversal location for attachments. 
After restore completes, a web shell is present in the application web root and can be invoked to execute commands. </p>
<h4>Alternateive Approach</h4>
<P>There exist an api which can take any file and uploads it to the <code>/home/allegra/reportTemplates/</code> folder</P>
<p>So instead of going through the entire process of building the reports package we can also use this api and change the backup location accordingly</p>
<p>However we figured this part after our submission and hence the exploit demonstrates the path that involves the report upload</p>
    
<h3>Proof of Concept</h3> 
<p> The PoC automates: 
  <ol> 
    <li>construction of the malicious inner backup zip (containing the web shell);</li>
     <li>wrapping the inner zip with the required <code>description.xml</code> into an outer report zip;</li> 
     <li>uploading the outer zip via the reports feature (to obtain the <code>XXX</code> ID);</li>
      <li>reconfiguring the backup directory to the corresponding <code>exportTemplate00XXX</code> folder;</li> 
    </ol>
   </p> 
   <p>All we should do is configure a remote Postgres Database start the restore operations.</p>
    <p> When executed, the process results in a web shell under <code>/usr/local/tomcat/webapps/demo/js/</code>, 
    enabling remote command execution via HTTP. </p>

<video controls preload="metadata">
  <source src="videos/dbbackuprestore.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>

<p>
  The exploit POC can can be found at : <a href="pocs/cve-2025-xxxx.py.txt">POC.py</a>
</p>

    <h2>Affected Versions</h2>
    <p>
      This vulnerability affects TrackPlus Allegra versions â‰¤ 8.1.6. Organizations using affected versions should immediately apply security patches.
    </p>

    <h2>Timeline</h2>
    <ul>
      <li><strong>Discovery:</strong> September 2025</li>
      <li><strong>Vendor Notification:</strong> September 2025</li>
      <li><strong>Fix Released</strong> October 2025</li>
      <li><strong>CVE Assignment:</strong> October 2025</li>
    </ul>

    <h2>References</h2>
    <ul>
      <li><a href="https://alltena.com/en/resources/release-notes/release-notes-for-release-8-1-7">TrackPlus Security Advisory</a></li>
    </ul>

    <p><em>This research was conducted by the ZDaylabs security team as part of our ongoing commitment to improving application security.</em></p>
  </main>
</body>
</html>
